# 点击高亮选中内容（菜单）

现在有一个需求：就是，点击哪一个元素，给哪一个元素设置一个`active`类，让他有高亮效果。



`vue`中实现的核心：

通过动态绑定`class`，和`@click`事件加上`v-for`循环出列表元素。

其中：动态`class`的判断条件是index和点击的`currentTab`，@click动态修改`currentTab`的值。



先看代码：

目的：现在想要的效果就是：点击了哪一个就给那个div添加active类，让它有高亮效果

**现在的结构**：

```html
<!--现在想要的效果就是：点击了哪一个就给那个div添加active类，让它有高亮效果-->
		<div class="tabs">
			<div class="tab active">
				<TheIcon icon="posts"></TheIcon>
				<p>我的</p>
			</div>

			<div class="tab">
				<TheIcon icon="like"></TheIcon>
				<p>赞过</p>
			</div>

			<div class="tab">
				<TheIcon icon="favorite"></TheIcon>
				<p>收藏</p>
			</div>
		</div>
```



## 具体操作步骤

>第一步：修改整体结构，让tabs是通过v-for指令渲染出来的。

代码：

```vue
<template>
		<div class="tabs">
			<div
				v-for="(tab, index) in tabs"
				:key="index"
				class="tab"
				:class="{ active: currentTab === index }"
			>
				<TheIcon :icon="tab.icon"></TheIcon>
				<p>{{ tab.label }}</p>
			</div>
		</div>
</template>
<script setup>
import TheIcon from '../components/TheIcon.vue';
import { computed, ref } from 'vue';
const tabs = ref([
	{
		label: '我的',
		icon: 'posts'
	},
	{
		label: '赞过',
		icon: 'like'
	},
	{
		label: '收藏',
		icon: 'favorite'
	}
]);

const currentTab = ref(0);
</script>
```





>第二步：通过@click动态的修改点击后的`currentTab`的值
>
>添加了一个@click事件

```vue
		<div class="tabs">
			<div
				v-for="(tab, index) in tabs"
				:key="index"
				class="tab"
				:class="{ active: currentTab === index }"
				@click="currentTab = index"
			>
				<TheIcon :icon="tab.icon"></TheIcon>
				<p>{{ tab.label }}</p>
			</div>
		</div>
```





## 小案例

点击那个菜单，获取对应的数据列表，并加载。

核心：

1）上面案例的方式

2）要和currentTab结合起来，创建数据存储列表

3）watch监听currentTab改变

```vue
<template>
	<div class="profileContainer">
		<div class="profile">
			<TheAvatar
				:src="'http://localhost:1337' + user.avatar"
				:width="186"
				:height="186"
			></TheAvatar>
			<div class="profileMeta">
				<div class="name">
					<span>{{ user.name }}</span>
					<router-link to="/profile/edit" class="">编辑个人资料</router-link>
				</div>
				<p class="handle">{{ user.username }}</p>
				<div class="description">
					<!-- pre标签能够保持原标签元素 -->
					<pre>{{ user.intro }}</pre>
					<span>{{ user.website }}</span>
				</div>
			</div>
		</div>
		<div class="tabs">
      <!--这里核心，让currentTab等于index-->
			<div
				v-for="(tab, index) in tabs"
				:key="index"
				class="tab"
				:class="{ active: currentTab === index }"
				@click="currentTab = index"
			>
				<TheIcon :icon="tab.icon"></TheIcon>
				<p>{{ tab.label }}</p>
			</div>
		</div>
		
		<div class="tabContent">
			<p>{{ myPosts[currentTab].length }}</p>
			<div class="posts">
        <!--根据点击的index(currentTab)来渲染数据-->
				<img
					v-for="post in myPosts[currentTab]"
					:src="post.image"
					:key="post.id"
					alt="图片"
					class="postImage"
				/>
			</div>
		</div>
	</div>
</template>
<script setup>
import TheAvatar from '../components/TheAvatar.vue';
import avatar from '../assets/avatar.png';
import TheIcon from '../components/TheIcon.vue';
import image from '../assets/图片1.jpeg';
import { loadPostsByMe, loadPostsLikedOrFavoredByMe } from '../apis/post';
import { useStore } from 'vuex';
import { computed, ref, reactive, watch } from 'vue';

const store = useStore();
const user = computed(() => store.state.user.user);

const tabs = ref([
	{
		label: '我的',
		icon: 'posts'
	},
	{
		label: '赞过',
		icon: 'like'
	},
	{
		label: '收藏',
		icon: 'favorite'
	}
]);
  
// 这里的currentTab要和对应的数据对应
const currentTab = ref(0);
/**
 * 0: 我发布的帖子列表
 * 1：我喜欢的帖子列表
 * 2：我收藏的帖子列表
 */
const myPosts = reactive({
	0: [],
	1: [],
	2: []
});

// 直接监听currentTab的变化，来动态发起请求取数据
// currentTab设计时取0,1,2
watch(
	currentTab,
	async () => {
		switch (currentTab.value) {
			case 0:
				if (myPosts[0].length === 0) {
					myPosts[0] = await loadPostsByMe();
				}
				break;

			case 1:
				if (myPosts[1].length === 0) {
					myPosts[1] = await loadPostsLikedOrFavoredByMe();
				}
				break;

			case 2:
				if (myPosts[2].length === 0) {
					myPosts[2] = await loadPostsLikedOrFavoredByMe('favors');
				}
				break;

			default:
				return;
		}
	},
	{ immediate: true }
);
</script>
```