# 小程序中组件通信方式(重要)



## 父子组件之间通讯

父子组件之间有三种方式：属性绑定、事件绑定、获取组件实例



### 属性绑定

用于父组件向子组件的指定属性设置数据，**仅能设置JSON兼容的数据。**类似于(vue的props)

父组件通过属性向子组件传值，子组件需要在`properties`中声明接收，并使用：

```html
// 父组件
<my-test5 count="{{count}}"></my-test5>
```

子组件：

```js
Component({
  /**
   * 组件的属性列表
   */
  properties: {
    count: Number
  }
})

// 组件wxml中使用
/*
<view>
  子组件中接收的count值：{{count}}
</view>
*/
```







### 事件绑定

**用于子组件向父组件传递数据**，可以传递任意数据

总共4步：

1）在父组件`js`文件中，定义一个函数

2）在父组件`wxml`中，通过自定义事件的形式，绑定第一步中定义的函数

3）在子组件的`js`中，通过调用`this.triggerEvent('自定义事件名称', {/*参数对象*/})`，将数据发送给父组件

4）在父组件的`js`中，通过`e.detail`获取子组件传递过来的数据



**自定义事件绑定的方式**

```html
<!--方式1使用bind:自定义事件名称(推荐使用)-->
<my-test3 bind:sync="syncCount"></my-test3>

<!--方式2使用bind后直接加上自定义事件名称-->
<my-test3 bindsync="syncCount"></my-test3>
```







### 获取组件实例(特殊)

在小程序中，父组件可以通过`this.selectComponent()`方法来获取组件实例，这也就能够访问子组件的任意数据和方法。



语法：

```js
this.selectComponent("id或者class选择器")

// 例如：
this.selectComponent('.my-component')
```



使用示例：

```js
// wxml结构
<my-test5 class="customA" id="child" count="{{count}}" bind:sync="syncCount"></my-test5>
<button bindtap="getChild">获取子组件示例</button>



// js事件
getChild() {
  // 获取到的child就是子组件实例
  const child = this.selectComponent('#child') //写.customA也可以
  // child.setData({ // child来操作组件内容
  //   count: child.properties.count + 1
  // })
  child.addCount()
}
```

