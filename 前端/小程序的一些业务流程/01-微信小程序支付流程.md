# 微信小程序支付流程



## 1.创建订单

首先：我们前端要请求创建订单的后端接口，把（订单金额，收获地址，订单中包含的商品信息）发送到服务器。

然后：服务器要响应**订单编号**



## 2.订单预支付

第二步：我们要请求订单预支付的`API`，把（订单编号）发送到服务器

服务器响应的结果：**订单预支付的参数对象，里面包含着订单支付相关的必要参数。**





## 3.发起微信支付

这个API需要有权限的：去官方文档自己查看

调用微信自带的`API`：`uni.requestPayment`，发起支付，将步骤2得到的订单预支付对象，作为参数传递给`uni.requestPayment()`方法。

监听：该方法的`success`、`fail`、`complete`回调，给用户进行支付结果的反馈（也可以直接用promise方式）

promise：

```js
const [err, succ] = await uni.requestPayment({
  payInfo
})
if(err) return uni.$showMsg('订单未支付');
```





### 3.1 支付完成后的操作

支付完成后，一般还会有一个检查订单是否完成的接口，调用此接口给用户进行反馈即可。